
# Copyright (C) Igor Sysoev
# Copyright (C) Nginx, Inc.


NGX_MAKEFILE=$NGX_OBJS/Makefile                                 # 最终执行编译 Makefile 文件的路径——Makefile 动态生成
NGX_MODULES_C=$NGX_OBJS/ngx_modules.c                           # 包含模块的源文件的路径——源文件动态生成

NGX_AUTO_HEADERS_H=$NGX_OBJS/ngx_auto_headers.h
NGX_AUTO_CONFIG_H=$NGX_OBJS/ngx_auto_config.h

NGX_AUTOTEST=$NGX_OBJS/autotest                                 # 自动测试目录与日志输出文件
NGX_AUTOCONF_ERR=$NGX_OBJS/autoconf.err                         # 如果configure 出错，可用来查找出错的原因

# STUBs
NGX_ERR=$NGX_OBJS/autoconf.err
MAKEFILE=$NGX_OBJS/Makefile


NGX_PCH=
NGX_USE_PCH=


# check the echo's "-n" option and "\c" capability

if echo "test\c" | grep c >/dev/null; then
    # 不支持 \c 的方式，检查是否支持 -n 
    if echo -n test | grep n >/dev/null; then
        ngx_n=
        ngx_c=

    else
        ngx_n=-n
        ngx_c=
    fi

else
    ngx_n=
    ngx_c='\c'
fi


# create Makefile

cat << END > Makefile

# 表示目前编译对象
default:	build

# 表示执行clean 工作时，表示需要删除 Makefile文件以及 objs 目录，整个过程中只会生成 Makefile 文件以及 objs 目录，其他所有临时文件都在 objs 目录下
# 执行 clean 后，整个目录还原到初始状态
# 再次执行编译，需要重新执行 configure 
clean:
	rm -rf Makefile $NGX_OBJS
END
